<?xml version="1.0" encoding="UTF-8" ?>
<!--
  FastRTPS profile matching grunt_bringup configuration for cross-VPN communication

  This profile mirrors barney's configuration:
  - Disables built-in transports
  - Uses custom UDP transport with interface whitelist
  - Initial peers list commented out (matching working ZeroTier setup)
-->
<profiles xmlns="http://www.eprosima.com">
  <transport_descriptors>
    <transport_descriptor>
      <transport_id>udp_transport</transport_id>
      <type>UDPv4</type>
      <interfaceWhiteList>
        <!-- Only include interfaces that actually exist with native Docker + mirrored networking.
             Non-existent IPs may cause transport to fail.
             Remote peers are specified in initialPeersList below.

             IMPORTANT: Update this list if your network configuration changes.
             Run 'ip addr show' in container to see current interfaces.
             Include: localhost, ZeroTier VPN, and docker bridge at minimum. -->
        <address>127.0.0.1</address>        <!-- localhost (always required) -->
        <address>10.147.20.21</address>     <!-- ZeroTier VPN (kvlapblack) -->
	      <address>10.147.20.22</address>     <!-- ZeroTier VPN (halbuntu) -->
      </interfaceWhiteList>
      <maxInitialPeersRange>100</maxInitialPeersRange>
    </transport_descriptor>
  </transport_descriptors>
  <participant profile_name="default_part_profile" is_default_profile="true">
    <rtps>
      <builtin>
        <initialPeersList>
          <!-- List remote peers to discover via unicast.
               Do NOT list unreachable peers - causes 3-5 second lag.
               Add robots as they come online on the VPN. -->

          <!-- localhost (for multi-node testing on same machine) -->
          <locator>
            <udpv4>
              <address>127.0.0.1</address>
            </udpv4>
          </locator>

          <!-- barney (primary development robot) -->
          <locator>
            <udpv4>
              <address>10.147.20.30</address>
            </udpv4>
          </locator>

          <!-- Add other robots here as needed:
          <locator>
            <udpv4>
              <address>10.147.20.33</address>  <!-\- wilma -\->
            </udpv4>
          </locator>
          -->
        </initialPeersList>
      </builtin>
      <useBuiltinTransports>false</useBuiltinTransports>
      <userTransports>
          <transport_id>udp_transport</transport_id>
      </userTransports>
    </rtps>
  </participant>
</profiles>
